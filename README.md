# Hash Generator

### :information_source: Topics
- [About the project](#blue_book-about-the-project)

- [Functionalities](#white_check_mark-functionalities)

- [Languages and libs used ](#books-languages-and-libs-used)

- [Prerequisites](#computer-prerequisites)

- [Running](#rocket-running)

- [Using the project](coffee-using-the-project)

- [License](pencil-license)


### :blue_book: About the project:

> When accessing a given route, several attempts are initiated to generate a hash from the entered string, which is concatenated with a random eight-digit string. The generated hash must start with four zeros as a prefix to be accepted. The maximum number of requests per minute is 10.

> Using the command by terminal when entering a string and a certain number of requests, the command will access the route and generate the hash of the string. From the given number of requests, the command will take the first generated hash and use it as a string to access the route again and so on, inserting the results in the database until reaching the given number of requests.

> Accessing the other route will display a list of all hashes generated by the command in the terminal, with paging and the display order can be changed by the number of hash generation attempts.

## :white_check_mark: Functionalities

:heavy_check_mark: Limit of 10 requests per minute;
<br>
- change this on:
```
#config\packages\rate_limiter.yaml

framework:
  rate_limiter:
    anonymous_api:
      # use 'sliding_window' if you prefer that policy
      policy: 'fixed_window'
      limit: {value}
      interval: '1 minutes'

```

:heavy_check_mark: Generate a hash starting with four zeros from a string concatenated with a random string of eight digits;

:heavy_check_mark: Command to use in a terminal generating a hash and inserting all the information into the database;

:heavy_check_mark: List all information in the database with paging

:heavy_check_mark: Rest

## :books: Languages and libs used 

- [PHP](https://www.php.net): version 8.1.1
- [MySQL](https://dev.mysql.com/downloads/installer/): version 8.0.27
- [Doctrine](https://www.doctrine-project.org/index.html)
- [KnpPaginationBundle](https://github.com/KnpLabs/KnpPaginatorBundle)

## :computer: Prerequisites

Before starting, make sure you meet the following requirements:

* If you have `symfony version 5.^`
* If you have a `Windows`
* You have installed the latest version of `PHP / Composer`
* You have installed `Postman`

## :rocket: Running 

To run `hash-gen`, follow the steps:

In the terminal, clone the project:
```
git clone https://github.com/ocowe1/hash-gen.git
```

Enter the project folder:

```
cd hash-gen
```

Install the dependencies

```
composer install
```

Configure the database open the file `.env`:
```
# Database configuration
DATABASE_URL="mysql://{your_user}:{your_password}@127.0.0.1:3306/{your_database}"
LOCK_DSN=flock
```

Create the table:
```
php bin/console doctrine:schema:create
```

Run the application
```
php -S 127.0.0.1:8000 -t public
```

## :coffee: Using the project

To use the project, follow the steps using `Postman` for the routes:

To generate a hash use the following route
```
127.0.0.1:8000/hash/{your_string}
```

The route will return something similar to this:
```
{
    "hash": "0000fc31622b0161d1820706a82bbe09", # the generated hash
    "key": "36fae104",                          # the random string
    "attempts": 473668,                         # the attempts to generate the key for generate the hash
    "string": "postman"                         # your input string
}
```

For the command:
```
php bin/console hash:gen {your_string} --requests={your_number_of_requests}
```

The command return something similar to this:
```
PS C:\dev\hash-gen> php bin/console hash:gen postman --requests=5
 ! [NOTE] Hash: 000010450f49640f20d4164285dffd2f, Key 8564d35d, Attempts 124046

 ! [NOTE] Hash: 000095619b475ab2e1b7b7cbe84c322f, Key 741fd7fd, Attempts 62688

 ! [NOTE] Hash: 000083aa5115e0c67d09d90f96fe92e9, Key 2b97bf16, Attempts 123302

 ! [NOTE] Hash: 0000fad898215c89310287c20c910924, Key f6a42737, Attempts 128162

 ! [NOTE] Hash: 000049224fff015145cd55970eebbb3e, Key 3e57a695, Attempts 3666
```

For the list route:
```
127.0.0.1:8000/list
```

You will get something like this:
```
[
    {
        "batch": "2022-01-08 02:01:36",
        "block": 1,
        "string": "banana",
        "key": "e69b8864",
        "attempts": 76790
    },
    {
        "batch": "2022-01-08 02:01:37",
        "block": 2,
        "string": "000006c9875f962cc8021aa68901de88",
        "key": "d868dcaa",
        "attempts": 392056
    },
    {
        "batch": "2022-01-08 05:01:38",
        "block": 1,
        "string": "postman",
        "key": "8564d35d",
        "attempts": 124046
    },
    {
        "batch": "2022-01-08 05:01:39",
        "block": 2,
        "string": "000010450f49640f20d4164285dffd2f",
        "key": "741fd7fd",
        "attempts": 62688
    },
    {
        "batch": "2022-01-08 05:01:39",
        "block": 3,
        "string": "000095619b475ab2e1b7b7cbe84c322f",
        "key": "2b97bf16",
        "attempts": 123302
    }
]
```

To paginate use `page={page}`:
```
127.0.0.1:8000/list?page=2
```

To sort by attempts use `sort=h.attempts&direction={DESC or ASC}`:
```
127.0.0.1:8000/list?sort=h.attempts&direction=asc&page=3
```

## :pencil: License

This project is under license. See the [LICENSE](LICENSE.md) file for more details.

[â¬† Voltar ao topo](#hash-gen)<br>
